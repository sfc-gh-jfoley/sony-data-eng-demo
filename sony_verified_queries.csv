question,sql,database,schema
"What are the top 5 franchises by total box office gross?","SELECT franchise, genre, title_count, total_gross_usd, total_streams FROM SONY_DE.PLATINUM.AGG_FRANCHISE_PERFORMANCE ORDER BY total_gross_usd DESC LIMIT 5",SONY_DE,PLATINUM
"Show me fan engagement metrics by region and account type","SELECT region, account_type, fan_count, avg_interactions, avg_titles_engaged FROM SONY_DE.PLATINUM.AGG_FAN_LIFETIME_VALUE ORDER BY fan_count DESC",SONY_DE,PLATINUM
"What is the total revenue and ticket sales for each title?","SELECT t.title_name, t.franchise, t.genre, SUM(f.total_gross_usd) AS total_revenue, SUM(f.total_tickets_sold) AS total_tickets, SUM(f.stream_count) AS total_streams FROM SONY_DE.GOLD.DT_FACT_DAILY_PERFORMANCE f JOIN SONY_DE.GOLD.DT_DIM_TITLES t ON f.title_id = t.title_id GROUP BY t.title_name, t.franchise, t.genre ORDER BY total_revenue DESC",SONY_DE,GOLD
"Show daily box office performance trends by region","SELECT report_date, region, SUM(total_gross_usd) AS daily_gross, SUM(total_tickets_sold) AS daily_tickets, SUM(unique_fans) AS daily_fans FROM SONY_DE.GOLD.DT_FACT_DAILY_PERFORMANCE GROUP BY report_date, region ORDER BY report_date DESC, daily_gross DESC",SONY_DE,GOLD
"Who are the most engaged fans by lifetime interactions?","SELECT first_name, last_name, region, account_type, lifetime_interactions, titles_engaged, preferred_device FROM SONY_DE.GOLD.DT_DIM_FANS ORDER BY lifetime_interactions DESC LIMIT 10",SONY_DE,GOLD
"What is the average ticket price by title and region?","SELECT t.title_name, f.region, AVG(f.avg_ticket_price_usd) AS avg_ticket_price, SUM(f.theater_count) AS total_theaters FROM SONY_DE.GOLD.DT_FACT_DAILY_PERFORMANCE f JOIN SONY_DE.GOLD.DT_DIM_TITLES t ON f.title_id = t.title_id GROUP BY t.title_name, f.region ORDER BY avg_ticket_price DESC",SONY_DE,GOLD
"Show fan signup trends by month and account type","SELECT DATE_TRUNC('month', signup_date) AS signup_month, account_type, COUNT(*) AS new_fans, AVG(lifetime_interactions) AS avg_interactions FROM SONY_DE.GOLD.DT_DIM_FANS GROUP BY signup_month, account_type ORDER BY signup_month DESC",SONY_DE,GOLD
"Which countries have the most recently active fans?","SELECT country_code, account_type, active_last_30_days, active_last_7_days, top_device FROM SONY_DE.PLATINUM.AGG_FAN_LIFETIME_VALUE WHERE active_last_30_days > 0 ORDER BY active_last_30_days DESC",SONY_DE,PLATINUM
"Show me the title catalog breakdown by genre and rating","SELECT genre, rating, COUNT(*) AS title_count, AVG(imdb_score) AS avg_imdb_score, AVG(runtime_minutes) AS avg_runtime, SUM(budget_usd) AS total_budget FROM SONY_DE.GOLD.DT_DIM_TITLES GROUP BY genre, rating ORDER BY title_count DESC",SONY_DE,GOLD
"Compare streaming versus theatrical performance by franchise","SELECT fp.franchise, fp.total_tickets, fp.total_gross_usd AS theatrical_gross, fp.total_streams, fp.total_unique_fans, ROUND(fp.total_gross_usd / NULLIF(fp.total_tickets, 0), 2) AS revenue_per_ticket FROM SONY_DE.PLATINUM.AGG_FRANCHISE_PERFORMANCE fp ORDER BY fp.total_gross_usd DESC",SONY_DE,PLATINUM
